"use strict";function onFinishRenderDirective($timeout){return{restrict:"A",link:function(scope){scope.$last===!0&&$timeout(function(){m_scroll()})}}}function m_scroll(){var fixFooterHeight=$("header").height(),windowHeight=$(window).height();$("#pList").height(windowHeight-fixFooterHeight),myScroll=new IScroll("#pList",{mouseWheel:!0,click:!0,disableMouse:!0,disablePointer:!0}),myScroll.on("scroll",staticTitle),myScroll.on("scrollEnd",staticTitle),myScroll.refresh()}function staticTitle(){-this.y+$("#pList").height()-$(".conul").height()>=0&&$("button").eq(0).click()}function list_tdk(){var tdk={val:api.getQueryString("keyworld")};tdk.val=decodeURI(tdk.val),null==tdk.val||""==tdk.val||void 0==tdk.val?tdk.val="悠哉":$("header").find(".title").children("h1").html(tdk.val+"产品"),$("title").html(tdk.val+"定制游_"+tdk.val+"定制旅游-众信悠哉旅游"),$("[name='keywords']").attr("content",tdk.val+"定制旅游,"+tdk.val+"定制游,"+tdk.val+"定制旅行")}function andriodGoBack(){window.location.href="https://mdingzhi.uzai.com/"}function productListResize(){var fixFooterHeight=$("header").height(),windowHeight=$(window).height();$("#pList").height(windowHeight-fixFooterHeight),myScroll.refresh()}var pageIndex=1,busy=!1,myScroll,uzaiApp=angular.module("uzaiApp",[]),devicetype=api.getQueryString("devicetype");api.__asyncLoadingCode__="0",uzaiApp.controller("IndexController",function($http,$scope){var param=JSON.stringify({QueryType:api.getQueryString("dingzhitype"),QueryValue:api.getQueryString("dingzhivalue"),PageIndex:pageIndex,PageSize:10});api.post($http,$scope,api.path.dingzhilogic,"UzaiProduct","GetProductList",param,function(obj){var errorTxt="暂无数据～";200==obj.ErrorCode||-3==obj.ErrorCode?(-3==obj.ErrorCode&&api.toast("网络连接失败,请重试～"),JSON.parse(obj.JsonResult).UzaiProductList.length<=0&&api.toast(errorTxt,99999),$scope.products=JSON.parse(obj.JsonResult).UzaiProductList,setTimeout(function(){$(".load-dialog").remove()},0)):(api.toast(errorTxt,99999),setTimeout(function(){$(".load-dialog").remove()},0)),list_tdk()},3),$scope.JumpPage=function(LinkUrl,ProductID,$event){if($scope.stopPropagation&&$event.stopPropagation(),api.setCookie("backUrl",window.location.href),null!=LinkUrl&&""!=LinkUrl){var jumpParam=encodeURI(JSON.stringify({ClassId:"跟团游",ProductId:ProductID}));"ios"==devicetype?api.invoke("action.opendetail",jumpParam):"android"==devicetype?window.action.exec("opendetail",jumpParam):window.location.href=LinkUrl}else api.setLocalStorage("ProductListURL",window.location.href),window.location.href="detail.html?ProductID="+ProductID},$scope.fn1=function(){if(!busy){var liNum=$("#scroller").children("li").length;if(2>liNum)return!1;busy=!0,pageIndex++;var param=JSON.stringify({QueryType:api.getQueryString("dingzhitype"),QueryValue:api.getQueryString("dingzhivalue"),PageIndex:pageIndex,PageSize:10});api.post($http,$scope,api.path.dingzhilogic,"UzaiProduct","GetProductList",param,function(obj){var errorTxt="没有更多产品啦～";if(200==obj.ErrorCode||-3==obj.ErrorCode){-3==obj.ErrorCode&&api.toast("网络连接失败,请重试～");var items=JSON.parse(obj.JsonResult).UzaiProductList;busy=!1,items.length<=0&&(busy=!0,api.toast(errorTxt,2e3));for(var i=0;i<items.length;i++)$scope.products.push(items[i]);var pageIndexs=pageIndex-1,pagesY=pageIndexs*($("#scroller").children("li").eq(0).height()+10)*9*-1;setTimeout(function(){myScroll.scrollTo(0,pagesY),myScroll.refresh()},200)}else api.toast(errorTxt,2e3)},0)}},$scope.isEven=function(url){return null!=url&&""!=url}}),uzaiApp.directive("onFinishRender",onFinishRenderDirective),uzaiApp.filter("trustHtml",function($sce){return function(input){return $sce.trustAsHtml(input)}}),window.andriodGoBack=andriodGoBack,window.androidGoBack=andriodGoBack,window.addEventListener("orientationchange",function(){productListResize()},!1);